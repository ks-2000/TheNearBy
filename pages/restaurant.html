<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>TheNearBy</title>

    <!-- materialize icons; css & js -->
    <link type="text/css" href="/css/rstyles.css" rel="stylesheet">
    <link type = "text/css" href="/css/materialize.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script type="text/javascript" src="/js/materialize.min.js"></script>
    <link rel = "manifest" href="/manifest.json">

    <!--ios support -->
    <link rel="apple-touch-icon" href="icons/apple-icon-180.png">

    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="icons/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
    <meta name="theme-color" content="#B83B5E">

</head>
<body class="grey lighten-4">

  <!-- top nav -->
  <nav style="background-color: #B83B5E;" class="z-depth-0">
    <div class="nav-wrapper container">
      <a href="/index.html"><span>TheNearBy</span></a>
      <span class="center white-text text-darken-1">
        <i class="material-icons sidenav-trigger" data-target="side-menu">menu</i>
      </span>
    </div>
  </nav>
  
    <!--Side menu-->
    <ul id="side-menu" class="sidenav side-menu">
      <li><a class="subheader">TheNearBy</a></li>
      <li><a href="/index.html" class="waves-effect">Home</a></li>
      <li><a href="/pages/about.html" class="waves-effect">About</a></li>      
    </ul>

     <!-- restaurants -->
     <div id="restaurant-details" class="details-container"></div>

      <script type="module">
/*----------------------Imports, Export and Configurations------------------------------------*/
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
       
       const firebaseConfig = {
         apiKey: "AIzaSyBqJ3jAAvudWn37JSOlRnQMLdiu-SzQ5fM",
         authDomain: "thenearby-pwa.firebaseapp.com",
         projectId: "thenearby-pwa",
         storageBucket: "thenearby-pwa.appspot.com",
         messagingSenderId: "966537773037",
         appId: "1:966537773037:web:858aa3abfda9bfd08ef1e4",
         measurementId: "G-ZZF165XZCE"
       };

       const app = initializeApp(firebaseConfig);

       import{
            getFirestore,doc, getDoc, getDocs, addDoc, onSnapshot, collection, query, where
          }
          from "https://www.gstatic.com/firebasejs/9.19.1/firebase-firestore.js";

      const db = getFirestore();
          
      const restaurantDetailsContainer = document.getElementById('restaurant-details');
      const urlParams = new URLSearchParams(window.location.search);
      
      const restaurantId = urlParams.get('id');
      console.log("restaurantId:", restaurantId);
 
      async function displayRestaurantDetails(restaurantId) {
        try {
          const docRef = doc(db, 'restaurants', restaurantId);
          const docSnapshot = await getDoc(docRef);

          if (docSnapshot.exists()) {
            const restaurantData = docSnapshot.data();
            const name = restaurantData.name;
            const location = restaurantData.location;
            const details = restaurantData.details;
            const map = restaurantData.map;
            

            //Creating HTML elements to display  restaurant details
            const nameElement = document.createElement('h5');
            nameElement.setAttribute('id', 'name-heading');
            nameElement.textContent = name;

            const locationElement = document.createElement('p');
            locationElement.textContent = location;
            locationElement.setAttribute('id', 'location');
            locationElement.appendChild(document.createElement("br"));

            const detailsElement = document.createElement('div');
            const detailsHeadingElement = document.createElement('h6');
            detailsHeadingElement.textContent = "Details of Restaurants";
            detailsHeadingElement.classList.add('details-heading');
            detailsHeadingElement.setAttribute('id', 'details-heading');
            const detailsTextElement = document.createElement('p');
            detailsTextElement.textContent = details;
            detailsElement.appendChild(document.createElement("br"));
            detailsElement.appendChild(detailsHeadingElement);
            detailsElement.appendChild(detailsTextElement);

            const mapElement = document.createElement('div');
            const mapHeadingElement = document.createElement('h6');
            mapHeadingElement.textContent = "Map";
            mapHeadingElement.classList.add('map-heading');
            mapHeadingElement.setAttribute('id', 'map-heading');
            mapElement.appendChild(mapHeadingElement);
            mapElement.appendChild(document.createElement("br"));
            mapElement.insertAdjacentHTML('beforeend', map);
            
  
            restaurantDetailsContainer.appendChild(nameElement);
            restaurantDetailsContainer.appendChild(locationElement);
            restaurantDetailsContainer.appendChild(detailsElement);
            restaurantDetailsContainer.appendChild(mapElement);

          } else {
            console.log('Invalid');
          }
        } catch (error) {
          console.log('Error', error);
        }
      }

      displayRestaurantDetails(restaurantId);

      </script>

<!------------------------Botton navigation bar------------------------------>
    <nav class="navigator">
        <a class="nav__link">
        </a>
    </nav>

<script src="/js/ui.js"></script>

</body>
</html>
